<!-- app/templates/base_scripts.html -->
{% extends "base.html" %}

{% block scripts %}
{{ super() }}
<script>
//Before removing an entry, a confirm-box is shown.  This function works together with on-draw.dt event here below
function confirm_before_delete() {
    id = $(this).attr('u_id');
    bootbox.confirm("Are you sure want to delete this " + '{{subject}}' + "?", function(result) {
        if (result) {
            window.location = Flask.url_for('{{subject}}' + ".delete", {'id' : id})
        }
    });
}

$(document).ready(function() {
    // When the length-changer or pager of the table is used, not all delete-buttons have the confirm-before-delete event
    // attached.  The event draw.dt makes sure that, after the table is redrawn (length change or repaged) that all rows
    // are bound to the confirm-before-delete event.

    $('.confirmBeforeDelete').click(confirm_before_delete); //when page is loaded, default attach confirm_before_delete function

    $('#{{table.html_attrs.id}}').on('draw.dt', function() {
        $('.confirmBeforeDelete').unbind();
        $('.confirmBeforeDelete').click(confirm_before_delete);
    });

    //The clear button of the filter is pushed
    $('#clear').click(function() {
        $('.filter').val('');
        window.location = Flask.url_for('{{route}}')
    });


    //Add the pager and export buttons above the table
    var table = $('#{{table.html_attrs.id}}').DataTable( {
        dom: 'lBfrtip',
        buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
        ]
    });
});
</script>
{% endblock %}
