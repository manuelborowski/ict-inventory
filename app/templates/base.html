<!-- app/templates/base.html -->
{% extends "bootstrap/base.html" %}

{% block head %}
{{ super() }}
{{ JSGlue.include() }}
{% endblock %}

{% block title %}
{{ title }} | IAI
{% endblock %}

{% block navbar %}
<nav class="navbar navbar-default navbar-fixed-top topnav" role="navigation">
    <div class="container topnav">
      <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand topnav">ICT Assets Inventory</a>
      </div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <ul class="nav navbar-nav navbar-right">
              {% if current_user.is_authenticated %}
                  <li><a href="{{ url_for('asset.assets') }}">Assets</a></li>
                  <li><a href="{{ url_for('purchase.purchases') }}">Purchases</a></li>
                  <li><a href="{{ url_for('device.devices') }}">Devices</a></li>
                  <li><a href="{{ url_for('supplier.suppliers') }}">Suppliers</a></li>
                  <li><a href="{{ url_for('user.users') }}">Users</a></li>
                  <li><a href="{{ url_for('auth.logout') }}">Logout</a></li>
                  <li><a><i class="fa fa-user"></i>  Hi, {{ current_user.username }}!</a></li>
              {% else %}
                  <li><a href="#">Login</a></li>
                  {% endif %}
          </ul>
      </div>
    </div>
</nav>
{% endblock %}

{% block styles %}
{{ super() }}
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.css"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
<link rel="shortcut icon" href="{{ url_for('static', filename='img/favicon.ico') }}">
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.10.15/css/jquery.dataTables.min.css"/>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/1.3.1/css/buttons.dataTables.min.css"/>
<link rel="stylesheet" type="text/css" href="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.css" />
{% endblock %}

{% block content %}
<div class="wrapper">
  {% block content2 %}
  {% endblock %}
  <div class="push"></div>
</div>
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <ul class="list-inline">
                    <li><a href="{{ url_for('auth.login') }}">Home</a></li>
                    <li class="footer-menu-divider">⋅</li>
                    {% if current_user.is_authenticated %}
                         <li><a href="#">Logout</a></li>
                    {% else %}
                        <li><a href="#">Register</a></li>
                        <li class="footer-menu-divider">⋅</li>
                        <li><a href="#"">Login</a></li>
                    {% endif %}
                    </ul>
                <p class="copyright text-muted small">Copyright © 2016. All Rights Reserved</p>
            </div>
        </div>
    </div>
</footer>
{% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.15/datatables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/bootbox.js/4.4.0/bootbox.min.js"></script>
<script type="text/javascript" src="//cdn.jsdelivr.net/bootstrap.daterangepicker/2/daterangepicker.js"></script>
<script type="text/javascript" src="https://code.jquery.com/jquery-1.12.4.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/1.10.15/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.flash.min.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/pdfmake.min.js"></script>
<script type="text/javascript" src="https://cdn.rawgit.com/bpampuch/pdfmake/0.1.27/build/vfs_fonts.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.html5.min.js"></script>
<script type="text/javascript" src="https://cdn.datatables.net/buttons/1.3.1/js/buttons.print.min.js"></script>
<script>
//Before removing an entry, a confirm-box is shown.  This function works together with on-draw.dt event here below
function confirm_before_delete() {
    id = $(this).attr('u_id');
    bootbox.confirm("Are you sure want to delete this " + '{{subject}}' + "?", function(result) {
        if (result) {
            window.location = Flask.url_for('{{subject}}' + ".delete", {'id' : id})
        }
    });
}

$(document).ready(function() {
    // When the length-changer or pager of the table is used, not all delete-buttons have the confirm-before-delete event
    // attached.  The event draw.dt makes sure that, after the table is redrawn (length change or repaged) that all rows
    // are bound to the confirm-before-delete event.

    $('.confirmBeforeDelete').click(confirm_before_delete); //when page is loaded, default attach confirm_before_delete function

    $('#{{table.html_attrs.id}}').on('draw.dt', function() {
        $('.confirmBeforeDelete').unbind();
        $('.confirmBeforeDelete').click(confirm_before_delete);
    });

    //The clear button of the filter is pushed
    $('#clear').click(function() {
        $('.filter').val('');
        window.location = Flask.url_for('{{route}}')
    });


    //Add the pager and export buttons above the table
    var table = $('#{{table.html_attrs.id}}').DataTable( {
        dom: 'lBfrtip',
        buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
        ]
    });
});
</script>


{% block scripts2 %}
{% endblock %}
{% endblock %}
